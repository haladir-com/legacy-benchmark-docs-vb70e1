---
title: "PRCSEQ"
description: "Process Sequence Definitions - defines batch job sequencing, dependencies, scheduling, and recovery parameters"
---

## Overview

PRCSEQ (Process Sequence) is a copybook that defines the record layout for batch process sequencing and dependency management. It provides a comprehensive structure for defining batch jobs, their execution order, timing constraints, dependencies on other processes, scheduling rules, and recovery procedures.

The copybook contains two main structures: PROCESS-SEQUENCE-RECORD for defining individual process entries with all their attributes, and STANDARD-SEQUENCES which provides predefined program lists for common batch processing phases (start-of-day, main processing, end-of-day).

This copybook is central to the batch scheduling infrastructure, enabling the system to manage complex job dependencies, enforce execution timing, and handle recovery scenarios when processes fail.

## Data Structures

### PROCESS-SEQUENCE-RECORD (Main Structure)

The primary record layout for process sequence definitions.

```
01  PROCESS-SEQUENCE-RECORD.
    05  PSR-KEY.
        10  PSR-PROCESS-ID    PIC X(8).
        10  PSR-VERSION       PIC 9(2).
    05  PSR-DATA.
        10  PSR-DESCRIPTION   PIC X(30).
        10  PSR-TYPE          PIC X(3).
        10  PSR-TIMING.
        10  PSR-DEPENDENCIES.
        10  PSR-CONTROL.
    05  PSR-SCHEDULE.
    05  PSR-RECOVERY.
    05  PSR-AUDIT.
    05  PSR-FILLER            PIC X(50).
```

### PSR-KEY Group (Record Key)

| Level | Name | Picture | Description |
|-------|------|---------|-------------|
| 05 | PSR-KEY | - | Primary key for indexed access |
| 10 | PSR-PROCESS-ID | X(8) | Unique process identifier |
| 10 | PSR-VERSION | 9(2) | Version number (00-99) |

### PSR-DATA Group (Core Process Information)

#### Basic Information

| Level | Name | Picture | Description |
|-------|------|---------|-------------|
| 10 | PSR-DESCRIPTION | X(30) | Human-readable process description |
| 10 | PSR-TYPE | X(3) | Process type code |

#### Process Type Values (88-level conditions)

| Value | Condition Name | Description |
|-------|----------------|-------------|
| 'INI' | PSR-TYPE-INIT | Initialization process |
| 'PRC' | PSR-TYPE-PROC | Main processing |
| 'RPT' | PSR-TYPE-RPT | Report generation |
| 'TRM' | PSR-TYPE-TERM | Termination/cleanup process |

### PSR-TIMING Subgroup

| Level | Name | Picture | Description |
|-------|------|---------|-------------|
| 10 | PSR-TIMING | - | Timing constraints |
| 15 | PSR-FREQ | X(1) | Execution frequency |
| 15 | PSR-START-TIME | 9(4) | Earliest start time (HHMM) |
| 15 | PSR-MAX-TIME | 9(4) | Latest completion time (HHMM) |

#### Frequency Values (88-level conditions)

| Value | Condition Name | Description |
|-------|----------------|-------------|
| 'D' | PSR-DAILY | Run every day |
| 'W' | PSR-WEEKLY | Run once per week |
| 'M' | PSR-MONTHLY | Run once per month |

### PSR-DEPENDENCIES Subgroup

| Level | Name | Picture | Description |
|-------|------|---------|-------------|
| 10 | PSR-DEPENDENCIES | - | Prerequisite processes |
| 15 | PSR-DEP-COUNT | 9(2) COMP | Number of dependencies (0-10) |
| 15 | PSR-DEP-ENTRY | OCCURS 10 | Dependency array |
| 20 | PSR-DEP-ID | X(8) | Dependent process ID |
| 20 | PSR-DEP-TYPE | X(1) | Dependency type (H/S) |
| 20 | PSR-DEP-RC | S9(4) COMP | Maximum acceptable return code |

#### Dependency Type Values (88-level conditions)

| Value | Condition Name | Description |
|-------|----------------|-------------|
| 'H' | PSR-DEP-HARD | Hard dependency - must complete successfully |
| 'S' | PSR-DEP-SOFT | Soft dependency - warning if not complete |

### PSR-CONTROL Subgroup

| Level | Name | Picture | Description |
|-------|------|---------|-------------|
| 10 | PSR-CONTROL | - | Execution control parameters |
| 15 | PSR-PROGRAM | X(8) | Program name to execute |
| 15 | PSR-PARM | X(50) | Parameter string for program |
| 15 | PSR-MAX-RC | S9(4) COMP | Maximum acceptable return code |
| 15 | PSR-RESTART | X(1) | Restart capability flag |

#### Restart Values (88-level conditions)

| Value | Condition Name | Description |
|-------|----------------|-------------|
| 'Y' | PSR-RESTARTABLE | Process can be restarted |
| 'N' | PSR-NO-RESTART | Process cannot be restarted |

### PSR-SCHEDULE Group

| Level | Name | Picture | Description |
|-------|------|---------|-------------|
| 05 | PSR-SCHEDULE | - | Scheduling rules |
| 10 | PSR-ACTIVE-DAYS | X(7) | Day-of-week mask (Sun-Sat) |
| 10 | PSR-MONTH-END | X(1) | Month-end only flag |
| 10 | PSR-HOLIDAY-RUN | X(1) | Holiday execution flag |

#### Active Days Values (88-level conditions)

| Value | Condition Name | Description |
|-------|----------------|-------------|
| 'YYYYYNN' | PSR-WEEKDAY | Monday through Friday only |
| 'NNNNNYY' | PSR-WEEKEND | Saturday and Sunday only |
| 'YYYYYYY' | PSR-ALL-DAYS | Every day of the week |

The 7-character mask represents Sunday through Saturday (positions 1-7), where 'Y' means run and 'N' means skip.

#### Month-End Values (88-level conditions)

| Value | Condition Name | Description |
|-------|----------------|-------------|
| 'Y' | PSR-LAST-DAY | Run only on last day of month |

#### Holiday Values (88-level conditions)

| Value | Condition Name | Description |
|-------|----------------|-------------|
| 'N' | PSR-SKIP-HOL | Skip execution on holidays |
| 'Y' | PSR-RUN-HOL | Run even on holidays |

### PSR-RECOVERY Group

| Level | Name | Picture | Description |
|-------|------|---------|-------------|
| 05 | PSR-RECOVERY | - | Recovery configuration |
| 10 | PSR-RECOVERY-PGM | X(8) | Recovery program name |
| 10 | PSR-RECOVERY-PARM | X(50) | Recovery program parameters |
| 10 | PSR-ERROR-LIMIT | 9(4) COMP | Maximum errors before abort |

### PSR-AUDIT Group

| Level | Name | Picture | Description |
|-------|------|---------|-------------|
| 05 | PSR-AUDIT | - | Audit trail information |
| 10 | PSR-CREATE-DATE | X(10) | Record creation date (YYYY-MM-DD) |
| 10 | PSR-CREATE-USER | X(8) | User who created record |
| 10 | PSR-UPDATE-DATE | X(10) | Last update date (YYYY-MM-DD) |
| 10 | PSR-UPDATE-USER | X(8) | User who last updated |

### PSR-FILLER

| Level | Name | Picture | Description |
|-------|------|---------|-------------|
| 05 | PSR-FILLER | X(50) | Reserved for future use |

## Standard Sequences

The copybook also defines predefined process sequences for common batch phases:

```
01  STANDARD-SEQUENCES.
    05  SEQ-START-OF-DAY.
        10  FILLER            PIC X(8) VALUE 'INITDAY '.
        10  FILLER            PIC X(8) VALUE 'CKPCLR  '.
        10  FILLER            PIC X(8) VALUE 'DATEVAL '.
    05  SEQ-MAIN-PROCESS.
        10  FILLER            PIC X(8) VALUE 'TRNVAL00'.
        10  FILLER            PIC X(8) VALUE 'POSUPD00'.
        10  FILLER            PIC X(8) VALUE 'HISTLD00'.
    05  SEQ-END-OF-DAY.
        10  FILLER            PIC X(8) VALUE 'RPTGEN00'.
        10  FILLER            PIC X(8) VALUE 'BCKLOD00'.
        10  FILLER            PIC X(8) VALUE 'ENDDAY  '.
```

### SEQ-START-OF-DAY (Initialization Phase)

| Position | Program | Purpose |
|----------|---------|---------|
| 1 | INITDAY | Initialize daily processing |
| 2 | CKPCLR | Clear checkpoints from previous day |
| 3 | DATEVAL | Validate processing date |

### SEQ-MAIN-PROCESS (Core Processing Phase)

| Position | Program | Purpose |
|----------|---------|---------|
| 1 | TRNVAL00 | Transaction validation |
| 2 | POSUPD00 | Position updates |
| 3 | HISTLD00 | History load |

### SEQ-END-OF-DAY (Termination Phase)

| Position | Program | Purpose |
|----------|---------|---------|
| 1 | RPTGEN00 | Report generation |
| 2 | BCKLOD00 | Backup load |
| 3 | ENDDAY | End-of-day cleanup |

## Record Layout

```
+------------------------------------------------------------------+
| PROCESS-SEQUENCE-RECORD                                           |
+------------------------------------------------------------------+
| PSR-KEY (10 bytes)                                               |
|   PSR-PROCESS-ID (8) | PSR-VERSION (2)                          |
+------------------------------------------------------------------+
| PSR-DATA                                                          |
|   PSR-DESCRIPTION (30)                                           |
|   PSR-TYPE (3)                                                   |
|   PSR-TIMING (9 bytes)                                           |
|     PSR-FREQ (1) | PSR-START-TIME (4) | PSR-MAX-TIME (4)         |
|   PSR-DEPENDENCIES (~112 bytes)                                  |
|     PSR-DEP-COUNT (2) | 10 x PSR-DEP-ENTRY (11 each)            |
|   PSR-CONTROL (~62 bytes)                                        |
|     PSR-PROGRAM (8) | PSR-PARM (50) | PSR-MAX-RC (2) |           |
|     PSR-RESTART (1)                                              |
+------------------------------------------------------------------+
| PSR-SCHEDULE (9 bytes)                                           |
|   PSR-ACTIVE-DAYS (7) | PSR-MONTH-END (1) | PSR-HOLIDAY-RUN (1)  |
+------------------------------------------------------------------+
| PSR-RECOVERY (60 bytes)                                          |
|   PSR-RECOVERY-PGM (8) | PSR-RECOVERY-PARM (50) |                |
|   PSR-ERROR-LIMIT (2)                                            |
+------------------------------------------------------------------+
| PSR-AUDIT (36 bytes)                                             |
|   PSR-CREATE-DATE (10) | PSR-CREATE-USER (8) |                   |
|   PSR-UPDATE-DATE (10) | PSR-UPDATE-USER (8)                     |
+------------------------------------------------------------------+
| PSR-FILLER (50 bytes)                                            |
+------------------------------------------------------------------+
```

## Usage Examples

### Defining a Daily Transaction Process

```cobol
INITIALIZE PROCESS-SEQUENCE-RECORD

* Set key
MOVE 'TRNVAL00' TO PSR-PROCESS-ID
MOVE 01 TO PSR-VERSION

* Set basic info
MOVE 'Daily Transaction Validation' TO PSR-DESCRIPTION
SET PSR-TYPE-PROC TO TRUE

* Set timing
SET PSR-DAILY TO TRUE
MOVE 0600 TO PSR-START-TIME
MOVE 0800 TO PSR-MAX-TIME

* Set dependencies (depends on INITDAY completing with RC <= 4)
MOVE 1 TO PSR-DEP-COUNT
MOVE 'INITDAY ' TO PSR-DEP-ID(1)
SET PSR-DEP-HARD(1) TO TRUE
MOVE 4 TO PSR-DEP-RC(1)

* Set control
MOVE 'TRNVAL00' TO PSR-PROGRAM
MOVE 'PARM=DAILY,MODE=FULL' TO PSR-PARM
MOVE 8 TO PSR-MAX-RC
SET PSR-RESTARTABLE TO TRUE

* Set schedule (weekdays only, skip holidays)
SET PSR-WEEKDAY TO TRUE
MOVE 'N' TO PSR-MONTH-END
SET PSR-SKIP-HOL TO TRUE

* Set recovery
MOVE 'TRNRECOV' TO PSR-RECOVERY-PGM
MOVE 'RESTART=Y' TO PSR-RECOVERY-PARM
MOVE 3 TO PSR-ERROR-LIMIT
```

### Checking Dependencies Before Execution

```cobol
* Loop through all dependencies
PERFORM VARYING WS-DEP-IX FROM 1 BY 1
        UNTIL WS-DEP-IX > PSR-DEP-COUNT
    
    MOVE PSR-DEP-ID(WS-DEP-IX) TO WS-CHECK-PROCESS
    PERFORM CHECK-PROCESS-STATUS
    
    IF PSR-DEP-HARD(WS-DEP-IX)
        IF WS-PROCESS-RC > PSR-DEP-RC(WS-DEP-IX)
            MOVE 'Hard dependency failed' TO WS-ERROR-MSG
            SET WS-CANNOT-RUN TO TRUE
        END-IF
    ELSE
        IF WS-PROCESS-RC > PSR-DEP-RC(WS-DEP-IX)
            MOVE 'Soft dependency warning' TO WS-WARN-MSG
            PERFORM LOG-WARNING
        END-IF
    END-IF
END-PERFORM
```

### Using Standard Sequences

```cobol
* Reference standard sequence for start of day
MOVE SEQ-START-OF-DAY TO WS-SEQUENCE-LIST

* Process each program in the sequence
PERFORM VARYING WS-POS FROM 1 BY 8
        UNTIL WS-POS > 24
    MOVE WS-SEQUENCE-LIST(WS-POS:8) TO WS-PROGRAM-NAME
    IF WS-PROGRAM-NAME NOT = SPACES
        PERFORM EXECUTE-PROGRAM
    END-IF
END-PERFORM
```

## Programs Using This Copybook

| Program | Description |
|---------|-------------|
| PRCSEQ00 | Process Sequence Manager - orchestrates batch job execution |
| RCVPRC00 | Recovery Process - handles job restart and recovery |

## Related Copybooks

| Copybook | Relationship |
|----------|--------------|
| BCHCTL | Batch control records - runtime job status tracking |
| BCHCON | Batch control constants - status values and thresholds |
| CKPRST | Checkpoint/restart - program-level restart support |

## Technical Notes

### Dependency Processing

Dependencies support two types:
- **Hard (H)**: Process cannot start until dependency completes with RC â‰¤ PSR-DEP-RC
- **Soft (S)**: Process can start but generates warning if dependency hasn't completed or exceeded RC threshold

### Scheduling Logic

The PSR-ACTIVE-DAYS field uses a 7-position mask:
- Position 1 = Sunday
- Position 2 = Monday
- Position 3 = Tuesday
- Position 4 = Wednesday
- Position 5 = Thursday
- Position 6 = Friday
- Position 7 = Saturday

Example: 'NYYYYYN' = Monday through Friday, skip weekends

### Time Format

PSR-START-TIME and PSR-MAX-TIME use 24-hour format (HHMM):
- 0600 = 6:00 AM
- 1430 = 2:30 PM
- 2359 = 11:59 PM

### Recovery Strategy

When a process fails:
1. Check PSR-RESTART flag - can it be restarted?
2. If yes, invoke PSR-RECOVERY-PGM with PSR-RECOVERY-PARM
3. Track error count against PSR-ERROR-LIMIT
4. Abort if error limit exceeded

### Version Control

The PSR-VERSION field (00-99) allows multiple versions of a process definition:
- Version 00 typically represents the current/active version
- Higher versions can be used for testing or scheduled changes

### COBOL Features Used

- **88-level condition names**: Extensively used for process types, frequencies, dependency types, scheduling flags
- **OCCURS clause**: PSR-DEP-ENTRY OCCURS 10 TIMES for dependency array
- **COMP (COMPUTATIONAL)**: Binary storage for counts and return codes
- **VALUE clause**: Predefined values in STANDARD-SEQUENCES
- **FILLER**: Used in standard sequences and for reserved space
